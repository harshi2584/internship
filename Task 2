import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import warnings

warnings.filterwarnings("ignore")
pd.set_option("display.max_columns", None)
sns.set(style="whitegrid")

df = pd.read_csv(path)

print(" First 5 rows:")
print(df.head())
print("\n Dataset Info:")
print(df.info())
print("\n Missing Values per Column:")
print(df.isnull().sum())

df["Age"] = df["Age"].fillna(df["Age"].median())
df["Embarked"] = df["Embarked"].fillna(df["Embarked"].mode()[0])
df = df.drop(columns=["Cabin"])
df = df.drop_duplicates()

print("\n Data cleaning complete!")
print(df.info())

print("\n Summary Statistics:")
print(df.describe())

plt.figure(figsize=(6, 4))
sns.countplot(x="Survived", hue="Survived", data=df, palette="coolwarm", legend=False)
plt.title("Survival Count")
plt.xlabel("Survived (0 = No, 1 = Yes)")
plt.ylabel("Count")
plt.show()

plt.figure(figsize=(6, 4))
sns.countplot(x="Sex", hue="Survived", data=df, palette="coolwarm")
plt.title("Survival by Gender")
plt.show()

plt.figure(figsize=(6, 4))
sns.countplot(x="Pclass", hue="Survived", data=df, palette="coolwarm")
plt.title("Survival by Passenger Class")
plt.show()

plt.figure(figsize=(7, 4))
sns.histplot(df["Age"], bins=30, kde=True, color="teal")
plt.title("Age Distribution of Passengers")
plt.xlabel("Age")
plt.ylabel("Frequency")
plt.show()

plt.figure(figsize=(8, 5))
sns.boxplot(x="Survived", y="Age", hue="Survived", data=df, palette="Set2", legend=False)
plt.title("Age vs Survival")
plt.xlabel("Survived (0 = No, 1 = Yes)")
plt.ylabel("Age")
plt.show()

plt.figure(figsize=(10, 6))
sns.heatmap(df.corr(numeric_only=True), annot=True, cmap="coolwarm", fmt=".2f")
plt.title("Correlation Heatmap")
plt.show()

plt.figure(figsize=(7, 4))
sns.countplot(x="Embarked", hue="Survived", data=df, palette="coolwarm")
plt.title("Survival by Embarkation Port")
plt.show()

plt.figure(figsize=(8, 5))
sns.boxplot(x="Pclass", y="Fare", hue="Pclass", data=df, palette="Set3", legend=False)
plt.title("Fare Distribution Across Passenger Classes")
plt.xlabel("Passenger Class")
plt.ylabel("Fare")
plt.show()

print("\n Key Insights:")
print("""
1. Gender: Females had a much higher survival rate than males.
2. Class: 1st-class passengers survived more often than 2nd or 3rd class.
3. Age: Younger passengers had slightly higher survival rates.
4. Fare: Higher fare correlates positively with survival chances.
5. Embarked Port: Passengers who embarked at 'C' (Cherbourg) had higher survival rates.
""")
